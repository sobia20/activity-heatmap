{"remainingRequest":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/src/components/HeatMap.vue?vue&type=style&index=0&id=48ce054c&scoped=true&lang=css&","dependencies":[{"path":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/src/components/HeatMap.vue","mtime":1581440837907},{"path":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/sobiaa/chEMBL-Heatmap/frontend/activity-heatmap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmgzIHsKICBtYXJnaW46IDQwcHggMCAwOwp9CnVsIHsKICBsaXN0LXN0eWxlLXR5cGU6IG5vbmU7CiAgcGFkZGluZzogMDsKfQpsaSB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIG1hcmdpbjogMCAxMHB4Owp9CmEgewogIGNvbG9yOiAjNDJiOTgzOwp9Cg=="},{"version":3,"sources":["HeatMap.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"HeatMap.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"not_heatmap\">\n    <div id=\"my_heatmap\" ></div>\n    <meta charset=\"utf-8\" http-equiv=\"encoding\">    \n    <button v-on:click=\"heatmap('http://localhost:5000/activities/activity_count', 'activity_count')\">Number fo Activity data points</button>\n    <button v-on:click=\"heatmap('http://localhost:5000/activities/max_pchembl_value', 'max_pchembl_value')\">Maximum pChEMBL_value</button>\n    <button v-on:click=\"heatmap('http://localhost:5000/activities/avg_pchembl_value', 'avg_pchembl_value')\">Average pChEMBL_value</button>\n    \n  </div>\n  \n</template>\n\n<script src=\"d3/d3.js\" charset=\"utf-8\"></script>\n<script charset=\"utf-8\"> \nimport * as d3 from 'd3';\n\nvar margin = {top: 30, right: 30, bottom: 30, left: 100},\n  width = 450 - margin.left - margin.right + 400,\n  height = 450 - margin.top - margin.bottom ;\n\nexport default {\n  name: 'HeatMap',\n  methods:{\n    heatmap(url_val, color_column){\n      d3.select(\"svg\").remove();\n      \n    // append the svg object to the body of the page\n      var svg = d3.select(\"#my_heatmap\")\n      .append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n        .attr(\"transform\",\n              \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    // Labels of row and columns\n    var target_values = [\"CHEMBL325\",\n    \"CHEMBL1937\",\n    \"CHEMBL1829\",\n    \"CHEMBL3524\",\n    \"CHEMBL2563\",\n    \"CHEMBL1865\",\n    \"CHEMBL2716\",\n    \"CHEMBL3192\",\n    \"CHEMBL4145\",\n    \"CHEMBL5103\",\n    \"CHEMBL3310\"]\n    var molecule_values = [\"CHEMBL98\",\n    \"CHEMBL99\",\n    \"CHEMBL27759\",\n    \"CHEMBL2018302\",\n    \"CHEMBL483254\",\n    \"CHEMBL1213490\",\n    \"CHEMBL356769\",\n    \"CHEMBL272980\",\n    \"CHEMBL430060\",\n    \"CHEMBL1173445\",\n    \"CHEMBL356066\",\n    \"CHEMBL1914702\"]\n\n    // Build X scales and axis:\n    var x = d3.scaleBand()\n      .range([ 0, width ])\n      .domain(target_values)\n      .padding(0.01);\n\n    svg.append(\"g\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x))\n\n    // Build Y scales and axis:\n    var y = d3.scaleBand()\n      .range([ height, 0 ])\n      .domain(molecule_values)\n      .padding(0.01);\n    \n    svg.append(\"g\")\n      .call(d3.axisLeft(y));\n      \n    console.log(width, height)\n\n    d3.json(url_val).then(function(data){\n\n        // Build color scale\n        const min = d3.min(data.map(d => d[color_column]));\n        const max = d3.max(data.map(d => d[color_column]));\n        console.log(min, max)\n        var myColor = d3.scaleLinear()\n          .domain([min , max ])\n          .range([\"#ddeeea\", \"#69b3a2\"]); \n         \n        \n        // console.log(data);     \n        var tooltip = d3.select(\"#my_heatmap\")\n          .append(\"div\")\n          .style(\"opacity\", 0)\n          .attr(\"class\", \"tooltip\")\n          .style(\"background-color\", \"white\")\n          .style(\"border\", \"solid\")\n          .style(\"border-width\", \"2px\")\n          .style(\"border-radius\", \"5px\")\n          .style(\"padding\", \"5px\")\n        // Three function that change the tooltip when user hover / move / leave a cell\n        var mouseover = function(d) {\n          tooltip.style(\"opacity\", 1)\n        }\n        var mousemove = function(d) {\n          tooltip\n            .html(\"The exact value of<br>this cell is: \" + d[color_column])\n            .style(\"left\", (d3.mouse(this)[0]+70) + \"px\")\n            .style(\"top\", (d3.mouse(this)[1]) + \"px\")\n        }\n        var mouseleave = function(d) {\n          tooltip.style(\"opacity\", 0)\n        }\n\n    // add the squares\n    svg.selectAll()\n      .data(data, function(d) {\n        return d['target']+':'+d['molecule'];})\n      .enter()\n      .append(\"rect\")\n        .attr(\"x\", function(d) { return x(d['target']) })\n        .attr(\"y\", function(d) { return y(d['molecule']) })\n        .attr(\"width\", x.bandwidth() )\n        .attr(\"height\", y.bandwidth() )\n        .style(\"fill\", function(d) { return myColor(d[color_column])} )\n      .on(\"mouseover\", mouseover)\n      .on(\"mousemove\", mousemove)\n      .on(\"mouseleave\", mouseleave)\n\n  }) \n    }\n  },\n  mounted(){\n      \n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n</style>\n"]}]}